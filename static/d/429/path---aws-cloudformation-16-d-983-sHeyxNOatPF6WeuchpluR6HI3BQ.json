{"data":{"site":{"siteMetadata":{"title":"DailyJSX","author":"Nadun Indunil"}},"markdownRemark":{"id":"c73100c6-3cf4-537c-8a25-5135c068efca","html":"<p>Today I am going to discuss Infrastructure as code service in AWS which is named as AWS Cloud Formation.</p>\n<p>AWS CloudFormation provides a common language for you to describe and provision all the infrastructure resources in your cloud environment. ​\nIt allows you to use a simple text file to model and provision, in an automated and secure manner, all the resources needed for your applications across all regions and accounts. ​This CFT file serves as a single source of truth for your cloud environment. </p>\n<blockquote>\n<p>AWS CloudFormation allows you to model your entire infrastructure in a text file (CloudFormation Template). </p>\n</blockquote>\n<p>Another advantage of using CFT for resource creation is CloudFormation takes care of determining the right operations to perform when managing your stack and rolls back changes automatically if errors are detected. Codifying your infrastructure allows you to treat your infrastructure as just code.</p>\n<p>In order to discuss more Cloud Formation I will separate my introduction into 3 sections: </p>\n<h3 id=\"what-is-cft\"><a href=\"#what-is-cft\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What Is CFT?</h3>\n<ul>\n<li>It is a declaration of the AWS resources that make up a stack. ​</li>\n<li>It is stored as a text file.​</li>\n<li>We can create and edit them in any text editor. ​</li>\n<li>It can be managed in your source control system with the rest of your source code.</li>\n</ul>\n<h3 id=\"why-cloudformation\"><a href=\"#why-cloudformation\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why CloudFormation?</h3>\n<ul>\n<li>It is just a simple code which can use to spin up your infrastructure.​</li>\n<li>Much easier than using the AWS console.</li>\n</ul>\n<h3 id=\"how-cloudformation-works\"><a href=\"#how-cloudformation-works\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How CloudFormation works?</h3>\n<ul>\n<li>AWS CloudFormation makes underlying service calls to AWS to provision and configures your resources. ​</li>\n<li>Can perform only actions that you have permission to do.</li>\n</ul>\n<p>I hope you got some idea about what CFT is, Let’s look about what are key components of CFT and how to use them.</p>\n<p><em>Note</em>: You can write CFT as JSON(Javascript Object Notation) files as well as YAML files. I highly encourage you to use YML because of clean code style and ability to comment in YMLs.</p>\n<h2 id=\"cloud-formation-template-components\"><a href=\"#cloud-formation-template-components\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cloud Formation Template Components</h2>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">AWSTemplateFormatVersion</span><span class=\"token punctuation\">:</span> <span class=\"token datetime number\">2010-09-09</span>\n<span class=\"token key atrule\">Description</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">Parameters</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">Mappings</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">Conditions</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">Resources</span><span class=\"token punctuation\">:</span>\nOutputs<span class=\"token punctuation\">:</span></code></pre></div>\n<h3 id=\"version--awstemplateformatversion-optional\"><a href=\"#version--awstemplateformatversion-optional\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Version – AWSTemplateFormatVersion (optional)​</h3>\n<p>identifies the capabilities of the template. The latest template format version is 2010-09-09 and is currently the only valid value. ​(Do not to put current date. It is just the version date. I have seen so many people put the date they run this file)</p>\n<h5 id=\"example\"><a href=\"#example\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>example</h5>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">AWSTemplateFormatVersion</span><span class=\"token punctuation\">:</span> <span class=\"token datetime number\">2010-09-09</span></code></pre></div>\n<h3 id=\"description-optional\"><a href=\"#description-optional\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description (optional)​</h3>\n<p>enables you to include arbitrary comments about your template. The Description must follow the AWSTemplateFormatVersion section​</p>\n<h5 id=\"example-1\"><a href=\"#example-1\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>example</h5>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">Description</span><span class=\"token punctuation\">:</span> This is test stack to deploy one EC2</code></pre></div>\n<h3 id=\"metadata-optional\"><a href=\"#metadata-optional\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Metadata (optional)​</h3>\n<p>objects that provide details about the template​</p>\n<h5 id=\"example-2\"><a href=\"#example-2\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>example</h5>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">Metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">Instances</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Information about the instances\"</span>\n  <span class=\"token key atrule\">Databases</span><span class=\"token punctuation\">:</span> \n    <span class=\"token key atrule\">Description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Information about the databases\"</span></code></pre></div>\n<h3 id=\"parameters-optional\"><a href=\"#parameters-optional\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parameters (optional)​</h3>\n<p>Parameters enable you to input custom values to your template each time you create or update a stack​. We can input these custom values from the AWS console before we run a template.</p>\n<p>We can find Two main parameter types:</p>\n<ul>\n<li>\n<p>General Parameter Types</p>\n<ul>\n<li>String : “string”​</li>\n<li>Number : 1​</li>\n<li>List<Number> : [1,2,3]​</li>\n<li>CommaDelimitedList : “1,2,3”</li>\n</ul>\n</li>\n<li>\n<p>AWS Specific Parameter Types</p>\n<ul>\n<li>AWS::EC2::Image::Id : “ami-b43503a4”​</li>\n<li>AWS::EC2::Instance::Id : “i-47cad982”​</li>\n<li>AWS::EC2::SecurityGroup::Id : “sg-6246b70c”​</li>\n<li>AWS::Route53::HostedZone::Id : “Z2VHZWU704GYI1”</li>\n</ul>\n</li>\n</ul>\n<p>Apart from data types we have <code class=\"language-text\">Intrinsic Functions</code>\nYou can find more details from <a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">here</a></p>\n<ul>\n<li>Fn::Base64</li>\n<li>Fn::Cidr</li>\n<li>Condition Functions</li>\n<li>Fn::FindInMap</li>\n<li>Fn::GetAtt</li>\n<li>Fn::GetAZs</li>\n<li>Fn::ImportValue</li>\n<li>Fn::Join</li>\n<li>Fn::Select</li>\n<li>Fn::Split</li>\n<li>Fn::Sub</li>\n<li>Fn::Transform</li>\n<li>Ref</li>\n</ul>\n<h5 id=\"example-3\"><a href=\"#example-3\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>example</h5>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">Parameters</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ApplicationName</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Description</span><span class=\"token punctuation\">:</span> Name of application\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> String\n    <span class=\"token key atrule\">Default</span><span class=\"token punctuation\">:</span> testEC2\n    <span class=\"token key atrule\">MinLength</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'1'</span>\n    <span class=\"token key atrule\">MaxLength</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'255'</span>\n    <span class=\"token key atrule\">AllowedPattern</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'[\\x20-\\x7E]*'</span>\n    <span class=\"token key atrule\">ConstraintDescription</span><span class=\"token punctuation\">:</span> Must contain only ASCII characters.</code></pre></div>\n<ul>\n<li>You can define min or max length of parameter, Type of parameter even a pattern</li>\n<li><code class=\"language-text\">ConstraintDescription</code> will be shown when pattern is not satisfied</li>\n<li>We can use <code class=\"language-text\">ApplicationName</code> inside this YAML file as a variable</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token tag\">!Ref</span> ApplicationName</code></pre></div>\n<h3 id=\"mapping-optional\"><a href=\"#mapping-optional\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mapping (optional)​</h3>\n<p>matches a key to a corresponding set of named values. For example, if you want to set values based on a region, you can create a mapping that uses the region name as a key and contains the values you want to specify for each specific region.​ (It is a normal map we see in day to day life)</p>\n<h5 id=\"example-4\"><a href=\"#example-4\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>example</h5>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">Mappings</span><span class=\"token punctuation\">:</span> \n  <span class=\"token key atrule\">RegionAndInstanceTypeToAMIID</span><span class=\"token punctuation\">:</span> \n    <span class=\"token key atrule\">us-east-1</span><span class=\"token punctuation\">:</span> \n      <span class=\"token key atrule\">test</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ami-b70554c8\"</span>\n      <span class=\"token key atrule\">prod</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ami-cfe4b2b0\"</span>\n    <span class=\"token key atrule\">us-west-2</span><span class=\"token punctuation\">:</span> \n      <span class=\"token key atrule\">test</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ami-b70554c8\"</span>\n      <span class=\"token key atrule\">prod</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ami-cfe4b2b0\"</span></code></pre></div>\n<p>You can use this map as </p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token tag\">!FindInMap</span> <span class=\"token punctuation\">[</span>RegionAndInstanceTypeToAMIID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"us-east-1\"</span><span class=\"token punctuation\">,</span> <span class=\"token tag\">!Ref</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">]</span>   <span class=\"token comment\"># answer is: ami-b70554c8</span></code></pre></div>\n<h3 id=\"conditions-optional\"><a href=\"#conditions-optional\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conditions (optional)​</h3>\n<p>statements that define when a resource is created or when a property is defined​</p>\n<h5 id=\"example-5\"><a href=\"#example-5\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>example</h5>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">Conditions</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">CreateProdResources</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Equals</span> <span class=\"token punctuation\">[</span> <span class=\"token tag\">!Ref</span> EnvironmentType<span class=\"token punctuation\">,</span> prod <span class=\"token punctuation\">]</span></code></pre></div>\n<p>you can use conditions as</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token tag\">!If</span> <span class=\"token punctuation\">[</span>CreateProdResources<span class=\"token punctuation\">,</span> t2.micro<span class=\"token punctuation\">,</span> t2.nano<span class=\"token punctuation\">]</span> <span class=\"token comment\"># If CreateProdResources is true then t2.micro else t2.nano</span></code></pre></div>\n<h3 id=\"resources-required\"><a href=\"#resources-required\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Resources (Required)​</h3>\n<p>Resources component declares the AWS resources that you want to include in the stack, such as an Amazon EC2 instance or an Amazon S3 bucket.​</p>\n<h5 id=\"example-6\"><a href=\"#example-6\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>example</h5>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">Resources</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">testEC2</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'AWS::EC2::Instance'</span>\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">DisableApiTermination</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'true'</span>\n      <span class=\"token key atrule\">AvailabilityZone</span><span class=\"token punctuation\">:</span> us<span class=\"token punctuation\">-</span>east<span class=\"token punctuation\">-</span>1c\n      <span class=\"token key atrule\">ImageId</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!FindInMap</span> <span class=\"token punctuation\">[</span>RegionAndInstanceTypeToAMIID<span class=\"token punctuation\">,</span> <span class=\"token tag\">!Ref</span> <span class=\"token string\">\"AWS::Region\"</span><span class=\"token punctuation\">,</span> <span class=\"token tag\">!Ref</span> EnvironmentType<span class=\"token punctuation\">]</span>   <span class=\"token comment\"># using map</span>\n      <span class=\"token key atrule\">InstanceType</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!If</span> <span class=\"token punctuation\">[</span>CreateProdResources<span class=\"token punctuation\">,</span> t2.micro<span class=\"token punctuation\">,</span> t2.nano<span class=\"token punctuation\">]</span>   <span class=\"token comment\"># using conditions</span>\n      <span class=\"token key atrule\">KeyName</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> KeyName  <span class=\"token comment\"># this is the key name you created</span>\n      <span class=\"token key atrule\">SecurityGroupIds</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token tag\">!Ref</span> WebSG\n      <span class=\"token key atrule\">BlockDeviceMappings</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">DeviceName</span><span class=\"token punctuation\">:</span> /dev/xvda\n          <span class=\"token key atrule\">Ebs</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">VolumeSize</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> RootVolumeSize\n            <span class=\"token key atrule\">VolumeType</span><span class=\"token punctuation\">:</span> gp2\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">DeviceName</span><span class=\"token punctuation\">:</span> /dev/sdf\n          <span class=\"token key atrule\">Ebs</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">VolumeSize</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> AppVolumeSize\n            <span class=\"token key atrule\">VolumeType</span><span class=\"token punctuation\">:</span> gp2\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">DeviceName</span><span class=\"token punctuation\">:</span> /dev/sds\n          <span class=\"token key atrule\">Ebs</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">VolumeSize</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> SwapDisk\n            <span class=\"token key atrule\">VolumeType</span><span class=\"token punctuation\">:</span> gp2\n      <span class=\"token key atrule\">Tags</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> testEC2\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Application_Name\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ApplicationName\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">Key</span><span class=\"token punctuation\">:</span> Application_Id\n          <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> ApplicationId</code></pre></div>\n<ul>\n<li><code class=\"language-text\">testEC2</code> will work as a variable name, hereafter you can use it to refer this EC2 instance</li>\n<li>Explore usage of <code class=\"language-text\">!Ref</code> to usage of parameters</li>\n</ul>\n<h3 id=\"outputs-optional\"><a href=\"#outputs-optional\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Outputs (optional)​</h3>\n<p>Outputs section declares output values that you can import into other stacks (to cross stack references)​</p>\n<h5 id=\"example-7\"><a href=\"#example-7\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>example</h5>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">Outputs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">MYEC2</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Description</span><span class=\"token punctuation\">:</span> EC2 detail\n    <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Ref</span> testEC2\n    <span class=\"token key atrule\">Export</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">Name</span><span class=\"token punctuation\">:</span> <span class=\"token tag\">!Sub</span> <span class=\"token string\">\"${AWS::StackName}-EC2\"</span>\n  <span class=\"token key atrule\">EC2PUBLICIP</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Description</span><span class=\"token punctuation\">:</span> Public IP Address\n    <span class=\"token key atrule\">Value</span><span class=\"token punctuation\">:</span>\n      <span class=\"token tag\">!GetAtt</span> testEC2.PublicIp</code></pre></div>\n<p>You can find whole YAML file from here: <a href=\"https://github.com/nadunindunil/AWS-DEMO/blob/master/ec2.yaml\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/nadunindunil/AWS-DEMO/blob/master/ec2.yaml</a></p>","timeToRead":6,"frontmatter":{"title":"Introduction to AWS Cloud​Formation","date":"May 18, 2019","spoiler":"Why what and how in AWS Cloud​Formation","author":"Nadun Indunil","tags":["AWS","CloudFormation","intro"]},"fields":{"slug":"/aws-cloudformation/","langKey":"en"}}},"pageContext":{"slug":"/aws-cloudformation/","previous":{"fields":{"slug":"/laravel-s3-file-upload/","langKey":"en","directoryName":"laravel-s3-file-upload"},"frontmatter":{"title":"How to upload files from Laravel project to AWS S3","tags":["Laravel","AWS","S3"]}},"next":null,"translations":[],"translatedLinks":[]}}